<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>S'peach: teaching children with autism how to read</title>

		<!-- Bootstrap -->
		<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
		
		<!-- Speach CSS -->
		<link rel="stylesheet" href="css/default.css">
		<link rel="stylesheet" href="css/word_matching.css">
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		  <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
		
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"/>
	</head>
	
	<body>
	<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	  <div class="container">
	<div class="navbar-header">
	  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	    <span class="sr-only">Toggle navigation</span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	  </button>
	  <a class="navbar-brand" href="index.html">S'peach</a>
	</div>
	<div class="collapse navbar-collapse">
	  <ul class="nav navbar-nav">
	    <li><a href="index.html">Home</a></li>
	    <li><a href="#about">About</a></li>
	    <li><a href="#a-propos">A propos</a></li>
	  </ul>
	</div><!--/.nav-collapse -->
	  </div>
	</div>
	
	<div class="container">
		<div class="row">
			<div class="col-sm-10">
				<div class="starter-template">
					<h1>J'assemble les deux mots qui riment</h1>
				</div>
			</div>
			<div class="col-sm-6 main">
				<div class="thumbnail">
					<img alt="cochon" src="img/obj/cochon.png">
					<span class="match" data-solution="poisson"></span>
					<span class="sound">&nbsp;</span>
				</div>
				
				<div class="thumbnail">
					<img alt="pain" src="img/obj/pain.png">
					<span class="match" data-solution="main"></span>
					<span class="sound">&nbsp;</span>
				</div>
				
				<div class="thumbnail">
					<img alt="bras" src="img/obj/bras.png">
					<span class="match" data-solution="chat"></span>
					<span class="sound">&nbsp;</span>
				</div>
				
				<div class="thumbnail">
					<img alt="lit" src="img/obj/lit.png">
					<span class="match" data-solution="souris"></span>
					<span class="sound">&nbsp;</span>
				</div>
				
				<div class="thumbnail">
					<img alt="cadeau" src="img/obj/cadeau.png">
					<span class="match" data-solution="chateau"></span>
					<span class="sound">&nbsp;</span>
				</div>
				
				<div class="thumbnail">
					<img alt="crevette" src="img/obj/crevette.png">
					<span class="match" data-solution="chaussette"></span>
					<span class="sound">&nbsp;</span>
				</div>
					
				<div class="result-btn">
					<p>
						<span>Tu joues pour:</span>
						<span id="score">
							<span class="star"></span>
							<span class="star"></span>
							<span class="star"></span>
							<span class="star"></span>
							<span class="star"></span>
							<span class="star"></span>
						</span>
						<a id="correction" class="btn btn-primary btn-long" role="button" href="#">OK</a>	
					</p>
				</div>
			</div>
			
			<div class="col-sm-3">
				<h2>Sac Ã  mots</h2>
				<div id="sac-mots">
					<div class="col-sm-1-5">
						<span class="match thumbnail">
							<img alt="chaussette" src="img/obj/chaussette.png">
							<span class="sound">&nbsp;</span>
						</span>
						<span class="match thumbnail">
							<img alt="main" src="img/obj/main.png">
							<span class="sound">&nbsp;</span>
						</span>
						<span class="match thumbnail">
							<img alt="chateau" src="img/obj/chateau.png">
							<span class="sound">&nbsp;</span>
						</span>
					</div>
					<div class="col-sm-1-5">
						<span class="match thumbnail">
							<img alt="souris" src="img/obj/souris.png">
							<span class="sound">&nbsp;</span>
						</span>
						<span class="match thumbnail">
							<img alt="chat" src="img/obj/chat.png">
							<span class="sound">&nbsp;</span>
						</span>
						<span class="match thumbnail">
							<img alt="poisson" src="img/obj/poisson.png">
							<span class="sound">&nbsp;</span>
						</span>
					</div>
				</div>
			</div>
			
			<div class="col-sm-2" id="right-colmn">
				<div class="thumbnail" id="cochon">
					<img alt="cochon" src="img/obj/cochon.png">
					<span class="tick-cross">&nbsp;</span>
				</div>
				<div class="thumbnail" id="pain">
					<img alt="pain" src="img/obj/pain.png">
					<span class="tick-cross">&nbsp;</span>
				</div>
				<div class="thumbnail" id="bras">
					<img alt="bras" src="img/obj/bras.png">
					<span class="tick-cross">&nbsp;</span>
				</div>
				<div class="thumbnail" id="lit">
					<img alt="lit" src="img/obj/lit.png">
					<span class="tick-cross">&nbsp;</span>
				</div>
				<div class="thumbnail" id="cadeau">
					<img alt="cadeau" src="img/obj/cadeau.png">
					<span class="tick-cross">&nbsp;</span>
				</div>
				<div class="thumbnail" id="crevette">
					<img alt="crevette" src="img/obj/crevette.png">
					<span class="tick-cross">&nbsp;</span>
				</div>
			</div>
		</div>
	</div>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	<!-- jQuery UI-->
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
	
	<script>
		$(document).ready(function(){
			activateChips();
			activateSounds();
			
			function activateChips(){
				$.each($("#sac-mots .thumbnail img"), function(index, value) {
					$(this).draggable({
						revert: "invalid",
					});
					$(this).css('-ms-touch-action', 'none');
				});
			}

			$.each($(".main .thumbnail"), function(index, value) {
				$(this).droppable({
					drop: function(event, ui){
						$.each($(this).children(".match"), function(index, value) {
							var new_img = ui.draggable.clone();
							$(this).append(new_img);
							new_img.css('top', '0');
							new_img.css('bottom', '0');
							new_img.css('left', '0');
							new_img.css('right', '0');
							ui.draggable.css('display', 'none');
							ui.draggable.parent().children(".sound").css('display', 'none');
							this.addEventListener("click", function() {
								deleteImgActivate($(this).children("img"));
								activateSounds();
							});
							return false;
						});
					},
					greedy: false,
					tolerance: 'pointer',
				});
			});
			
			function deleteImgActivate(elm)
			{
				elm.remove();
				$.each($("#sac-mots .thumbnail img"), function(index, value) {
					if ($(this).attr("alt") == elm.attr("alt"))
					{
						$(this).css('display', 'block');
						$(this).css('top', '0');
						$(this).css('bottom', '0');
						$(this).css('left', '0');
						$(this).css('right', '0');
						
						$(this).parent().children(".sound").css('display', 'block');
					}
				});
			}

			var audio = {};
			
			$.each($(".main .thumbnail img"), function(index, value) {
				// Preload all the sound files
				var thisAlt = $(this).attr("alt");
		        audio[thisAlt] = new Audio();
		        audio[thisAlt].src = 'audio/' + thisAlt + '.mp3';
		        
		        this.addEventListener("click", function() {
		            audio[thisAlt].play();
		        });
			});
			
			function activateSounds()
			{
				var audio = {};
				
				$.each($("#sac-mots .thumbnail img"), function(index, value) {
					// Preload all the sound files
					var thisAlt = $(this).attr("alt");
			        audio[thisAlt] = new Audio();
			        audio[thisAlt].src = 'audio/' + thisAlt + '.mp3';
			        
			        this.addEventListener("click", function() {
			            audio[thisAlt].play();
			        });
				});
			}
			
			$("#correction").click(function() {
				okSound = new Audio();
				okSound.src = 'audio/ok.mp3';
				okSound.play();
				
				var score = 0;
				$(".main .thumbnail").each(function(elmt) {
					var givenAnswer = $(this).children(".match").children("img").attr("alt");
					var correctAnswer = $(this).children(".match").attr("data-solution");
					var result = givenAnswer == correctAnswer;
					
					var timeItem = $("#" + $(this).children("img").attr("alt"));
					
					if(result)
					{
						timeItem.addClass("correct");
						timeItem.removeClass("incorrect");
						
						$(this).addClass("correct");
						$(this).removeClass("incorrect");
						score++;
					}
					else
					{
						timeItem.addClass("incorrect");
						timeItem.removeClass("correct");
						
						$(this).addClass("incorrect");
						$(this).removeClass("correct");
					}
				});

				var counter = 1;
				$("#score span").each(function(elmt) {
					if(counter <= score)
					{
						$(this).addClass("correct-star");
						$(this).removeClass("star");
					}
					counter++;
				});
				
				if (score == $(".main .thumbnail").length)
				{
					setInterval(function(){window.location.href = "bravo.html";},2000);
				}
			});
			
		});
	</script>
  </body>
</html>
